<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ARX | Interface Initialization</title>
  
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    /* ================= COMMON RESET ================= */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body { width: 100%; height: 100%; overflow: hidden; background: #000; }
    
    /* ================= LANDING PAGE ================= */
    #landing-container {
        position: absolute; inset: 0; width: 100%; height: 100%;
        font-family: "Space Grotesk", system-ui, sans-serif;
        color: #e8dcc0;
        z-index: 50;
        transition: opacity 0.5s;
    }

    #background { position: fixed; inset: 0; z-index: 0; transition: opacity 0.5s; }
    .nebula {
      position: absolute; inset: 0;
      background: url("https://raw.githubusercontent.com/mehul422/ArX/main/frontend/public/backiee-105012-landscape.jpg") center / cover no-repeat;
      animation: nebulaMove 80s linear infinite alternate;
      /* INCREASED BRIGHTNESS/GAMMA */
      filter: brightness(1.3) contrast(1.2) saturate(1.2); 
    }
    @keyframes nebulaMove { from { transform: scale(1); } to { transform: scale(1.1); } }
    
    .hero {
      position: relative; z-index: 2; height: 100vh;
      display: flex; flex-direction: column; justify-content: center; align-items: center;
      text-align: center; gap: 18px; perspective: 1000px;
    }

    .logo-container {
      position: relative; width: 160px; height: 160px;
      display: flex; justify-content: center; align-items: center;
      margin-bottom: 20px; transition: transform 1s, opacity 0.5s;
    }

    .logo { width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; animation: logoFloat 6s ease-in-out infinite; }
    .logo img { width: 300%; height: 300%; object-fit: contain; filter: drop-shadow(0 0 45px rgba(255,200,140,0.4)); }
    @keyframes logoFloat { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

    h1 { letter-spacing: 6px; font-size: 42px; font-weight: 600; color: #e8dcc0; text-shadow: 0 0 20px rgba(232,220,192,0.6); transition: 0.5s; }
    .hero p { letter-spacing: 3px; font-size: 13px; opacity: 0.8; transition: 0.5s; }

    .btn {
      margin-top: 20px; padding: 14px 36px; border-radius: 10px; border: none;
      background: linear-gradient(135deg, #f1c27d, #d4a256);
      color: #1b1407; font-weight: 600; letter-spacing: 2px; cursor: pointer;
      box-shadow: 0 10px 40px rgba(241,194,125,0.35); transition: all 0.2s; position: relative; z-index: 10;
    }
    .btn:hover { transform: translateY(-2px); box-shadow: 0 20px 60px rgba(241,194,125,0.55); }

    .hero.launching .logo-container { transform: translateY(-800px) scale(0.5); opacity: 0; }
    .hero.launching h1, .hero.launching p, .hero.launching .btn { opacity: 0; transform: scale(1.1); filter: blur(5px); transition-duration: 0.8s; }

    #stars { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; pointer-events: none; }
    .hyperspace-active #background { opacity: 0; }

    #warp-flash {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      background: #fff; opacity: 0; pointer-events: none; z-index: 9999;
    }
    #warp-flash.active { animation: flashAndFade 1.5s forwards; }
    @keyframes flashAndFade {
      0% { opacity: 0; background: #fff; }
      20% { opacity: 1; background: #fff; }
      100% { opacity: 1; background: #000; } 
    }

    #skip-btn {
        position: fixed; bottom: 30px; right: 30px;
        background: rgba(255, 0, 0, 0.2); border: 1px solid #ff3333;
        color: #ff3333; padding: 10px 20px; font-family: 'Orbitron', sans-serif; font-size: 0.8rem;
        cursor: pointer; z-index: 20000; letter-spacing: 2px; text-transform: uppercase;
        transition: 0.3s; opacity: 0; pointer-events: none; backdrop-filter: blur(5px);
    }
    #skip-btn.visible { opacity: 1; pointer-events: auto; }
    #skip-btn:hover { background: rgba(255, 0, 0, 0.6); box-shadow: 0 0 15px #ff3333; color: #fff; }

    #modeXSkipBtn {
        position: fixed; bottom: 30px; right: 30px;
        background: rgba(255, 215, 0, 0.1); border: 1px solid #ffd700;
        color: #ffd700; padding: 10px 20px; font-family: 'Orbitron', sans-serif; font-size: 0.8rem;
        cursor: pointer; z-index: 20001; letter-spacing: 2px; text-transform: uppercase;
        transition: 0.3s; opacity: 0; pointer-events: none; backdrop-filter: blur(5px);
        box-shadow: 0 0 10px rgba(255, 215, 0, 0.2);
    }
    #modeXSkipBtn.visible { opacity: 1; pointer-events: auto; }
    #modeXSkipBtn:hover { background: rgba(255, 215, 0, 0.4); box-shadow: 0 0 20px #ffd700; color: #fff; }

    /* ================= SYSTEM BOOT TEXT ================= */
    #boot-text {
        position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
        font-family: 'Orbitron', sans-serif; font-size: 3rem; color: #00f3ff;
        text-shadow: 0 0 20px rgba(0, 243, 255, 0.8); letter-spacing: 5px;
        opacity: 0; pointer-events: none; z-index: 10000;
        transition: opacity 0.5s ease-in-out;
    }
    .boot-text-visible { opacity: 1 !important; }

    /* ================= DASHBOARD STYLES ================= */
    :root {
        --bg-deep: #081018; /* BRIGHTER BACKGROUND */
        --bg-panel: rgba(10, 20, 30, 0.6);
        --cyan-primary: #00f3ff; 
        --cyan-dim: rgba(0, 243, 255, 0.2);
        --cyan-glow: rgba(0, 243, 255, 0.5); 
        --orange-alert: #ff9d00;
        --font-display: 'Orbitron', sans-serif; 
        --font-data: 'Rajdhani', monospace;
        
        /* DYNAMIC GRID COLOR */
        --grid-color: 0, 243, 255; 
    }

    #dashboard-container {
        display: none; width: 100%; height: 100%; position: relative; z-index: 10;
        color: var(--cyan-primary); font-family: var(--font-data);
    }

    .boot-hidden { opacity: 0; transform: translateY(20px); transition: all 0.8s ease-out; pointer-events: none; }
    .boot-scale-hidden { opacity: 0; transform: scale(0.8); transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1); pointer-events: none; }
    .boot-visible { opacity: 1; transform: translateY(0); pointer-events: auto; }
    .boot-scale-visible { opacity: 1; transform: scale(1); pointer-events: auto; }

    body.dashboard-mode {
        background-color: var(--bg-deep);
        
        /* ALTERNATING GRID: BRIGHT (0.3) & DIM (0.05) USING VAR */
        background-image: 
            linear-gradient(
                rgba(var(--grid-color), 0.3) 1px, 
                transparent 1px, 
                transparent 30px, 
                rgba(var(--grid-color), 0.05) 30px, 
                rgba(var(--grid-color), 0.05) 31px, 
                transparent 31px
            ),
            linear-gradient(90deg, 
                rgba(var(--grid-color), 0.3) 1px, 
                transparent 1px, 
                transparent 30px, 
                rgba(var(--grid-color), 0.05) 30px, 
                rgba(var(--grid-color), 0.05) 31px, 
                transparent 31px
            );
        background-size: 60px 60px;
    }
    body.dashboard-mode::after {
        content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        background: radial-gradient(circle at 50% 50%, transparent 20%, #000000 90%);
        pointer-events: none; z-index: 0;
    }

    .reactor-ring { width: 70vh; height: 70vh; border: 2px dashed var(--cyan-primary); border-radius: 50%; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); animation: rotateRight 120s linear infinite; z-index: 1; opacity: 0; box-shadow: 0 0 25px var(--cyan-glow), inset 0 0 20px var(--cyan-glow); transition: opacity 2s ease, border-color 2.5s ease, box-shadow 2.5s ease; }
    .reactor-ring-inner { width: 50vh; height: 50vh; border: 2px solid var(--cyan-primary); border-radius: 50%; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); animation: rotateLeft 60s linear infinite; z-index: 1; opacity: 0; box-shadow: 0 0 30px var(--cyan-glow), inset 0 0 25px var(--cyan-glow); transition: opacity 2s ease, border-color 2.5s ease, box-shadow 2.5s ease; }
    @keyframes rotateRight { 100% { transform: translate(-50%, -50%) rotate(360deg); } }
    @keyframes rotateLeft { 100% { transform: translate(-50%, -50%) rotate(-360deg); } }

    .top-nav { display: flex; justify-content: space-between; align-items: center; padding: 15px 40px; width: 100%; height: 80px; flex-shrink: 0; background: linear-gradient(180deg, rgba(0,243,255,0.05) 0%, transparent 100%); border-bottom: 1px solid var(--cyan-dim); position: relative; z-index: 10; transition: opacity 0.8s ease, transform 0.8s ease; }
    .main-stage { display: grid; grid-template-columns: 280px 1fr 280px; height: calc(100vh - 80px); width: 100%; padding: 20px; gap: 20px; position: relative; z-index: 5; overflow: hidden; }

    .hud-panel { display: flex; flex-direction: column; gap: 20px; padding: 15px; border: 1px solid var(--cyan-dim); background: rgba(0, 0, 0, 0.3); position: relative; overflow: hidden; transition: opacity 0.8s ease, transform 0.8s ease; }
    .hud-panel::before { content: ''; position: absolute; top: 0; left: 0; width: 10px; height: 10px; border-top: 2px solid var(--cyan-primary); border-left: 2px solid var(--cyan-primary); }
    .hud-panel::after { content: ''; position: absolute; bottom: 0; right: 0; width: 10px; height: 10px; border-bottom: 2px solid var(--cyan-primary); border-right: 2px solid var(--cyan-primary); }
    .panel-header { font-family: var(--font-display); font-size: 1rem; color: var(--cyan-primary); border-bottom: 1px solid var(--cyan-dim); padding-bottom: 5px; margin-bottom: 5px; text-align: center; letter-spacing: 2px; }

    .graph-container { flex: 1; position: relative; overflow: hidden; display: flex; align-items: flex-end; justify-content: flex-start; border-left: 1px solid var(--cyan-dim); border-bottom: 1px solid var(--cyan-dim); }
    .thrust-line { fill: none; stroke: var(--orange-alert); stroke-width: 2; vector-effect: non-scaling-stroke; filter: drop-shadow(0 0 4px var(--orange-alert)); animation: dashScroll 2s linear infinite; }
    @keyframes dashScroll { from { stroke-dashoffset: 0; } to { stroke-dashoffset: -100; } }
    
    .center-stage { display: flex; align-items: center; justify-content: center; }
    .grid-container { display: grid; grid-template-columns: repeat(3, 200px); gap: 20px; transition: opacity 0.8s ease, transform 0.8s ease;}
    
    .module-card { background-color: var(--bg-panel); position: relative; display: flex; flex-direction: column; justify-content: center; align-items: center; cursor: pointer; backdrop-filter: blur(4px); clip-path: polygon(20px 0, 100% 0, 100% calc(100% - 20px), calc(100% - 20px) 100%, 0 100%, 0 20px); border-left: 1px solid var(--cyan-dim); border-right: 1px solid var(--cyan-dim); height: 200px; transition: transform 0.3s ease, background-color 0.3s ease, border-color 0.3s ease, opacity 0.5s; }
    .module-card:hover { transform: translateY(-8px); background-color: rgba(0, 243, 255, 0.1); border-color: var(--cyan-primary); box-shadow: 0 10px 30px rgba(0, 243, 255, 0.15); }
    .module-card::before { content: ""; position: absolute; top: 0; left: 20px; right: 0; height: 1px; background: var(--cyan-dim); }
    .module-card .card-border-bottom { position: absolute; bottom: 0; right: 20px; left: 0; height: 1px; background: var(--cyan-dim); }
    .module-card::after { content: ""; position: absolute; top: 0; left: 0; right: 0; bottom: 0; box-shadow: inset 0 0 20px rgba(0, 243, 255, 0.05); pointer-events: none; z-index: -1; }
    
    .card-square { aspect-ratio: 1 / 1; }
    .card-wide { grid-column: 1 / -1; height: 100px; }
    .card-label { color: var(--cyan-primary); font-family: var(--font-display); font-size: 1.2rem; text-transform: uppercase; text-shadow: 0 0 5px var(--cyan-glow); z-index: 2; transition: color 1s ease;}
    .card-subtext { color: var(--cyan-dim); font-size: 0.7rem; margin-top: 5px; font-family: var(--font-data); letter-spacing: 2px; }
    .module-card.red-alert { --bg-panel: rgba(40, 0, 0, 0.6); --cyan-primary: #ff3333; --cyan-dim: rgba(255, 51, 51, 0.3); --cyan-glow: rgba(255, 51, 51, 0.8); border-color: #ff3333; }
    .module-card.red-alert:hover { transform: translateY(-8px); background-color: rgba(255, 51, 51, 0.15); box-shadow: 0 10px 30px rgba(255, 51, 51, 0.2); }

    .profile-container { position: relative; display: inline-block; }
    .dropdown-menu { display: none; position: absolute; top: 100%; left: 0; background: rgba(0, 10, 20, 0.95); border: 1px solid var(--cyan-primary); padding: 10px; min-width: 150px; z-index: 1000; box-shadow: 0 0 15px rgba(0, 243, 255, 0.2); }
    .profile-container:hover .dropdown-menu { display: block; }
    .dropdown-item { color: var(--cyan-primary); font-family: var(--font-display); font-size: 0.8rem; letter-spacing: 1px; padding: 8px 12px; cursor: pointer; text-decoration: underline; transition: 0.3s; }
    .dropdown-item:hover { text-shadow: 0 0 8px var(--cyan-primary); background: rgba(0, 243, 255, 0.1); }
    .profile-bubble { width: 48px; height: 48px; clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%); background: rgba(0,243,255,0.1); border: 1px solid var(--cyan-primary); display: flex; justify-content: center; align-items: center; position: relative; }
    .profile-bubble::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: var(--cyan-primary); clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%); z-index: -1; transform: scale(1.1); opacity: 0.5; }
    .nav-right { display: flex; gap: 30px; }
    .nav-link { background: transparent; border: 1px solid transparent; color: var(--cyan-primary); font-family: var(--font-display); font-size: 0.8rem; letter-spacing: 2px; text-transform: uppercase; cursor: pointer; padding: 8px 16px; transition: 0.3s; }
    .nav-link:hover { background: rgba(0,243,255,0.1); border-color: var(--cyan-dim); box-shadow: 0 0 10px var(--cyan-dim); text-shadow: 0 0 5px var(--cyan-primary); }
    .nav-link.accent { color: var(--orange-alert); }
    .nav-link.accent:hover { border-color: var(--orange-alert); box-shadow: 0 0 10px rgba(255,157,0,0.4); text-shadow: 0 0 5px var(--orange-alert); }
    .tech-corner-text { position: absolute; font-size: 0.5rem; color: var(--cyan-dim); opacity: 0.7; }
    .tr { top: 8px; right: 8px; text-align: right; }
    .bl { bottom: 8px; left: 8px; }

    .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.9); display: none; justify-content: center; align-items: center; z-index: 1000; backdrop-filter: blur(10px); }
    .modal-content { background: #050505; border: 1px solid #ff3333; padding: 40px; text-align: center; width: 450px; box-shadow: 0 0 40px rgba(255, 51, 51, 0.3); }
    .modal-text { font-family: var(--font-data); color: #fff; margin-bottom: 30px; font-size: 1.2rem; line-height: 1.5; letter-spacing: 1px; }
    .fade-exit { opacity: 0 !important; transform: scale(0.95); pointer-events: none; }
    
    /* === MODE X ANIMATIONS === */
    .mode-x-center { 
        position: fixed !important; 
        top: 50% !important; 
        left: 50% !important; 
        transform: translate(-50%, -50%); 
        z-index: 500 !important; 
        margin: 0 !important; 
        width: 400px !important; 
        transition: all 1.5s ease-in-out !important; 
        pointer-events: none !important; 
    }

    .shake-hard {
        animation: shake-center 0.1s infinite !important;
    }

    @keyframes shake-center {
        0% { transform: translate(-50%, -50%) rotate(0deg); }
        25% { transform: translate(calc(-50% - 5px), calc(-50% + 5px)) rotate(-2deg); }
        50% { transform: translate(calc(-50% + 5px), calc(-50% - 5px)) rotate(2deg); }
        75% { transform: translate(calc(-50% - 5px), calc(-50% - 5px)) rotate(-2deg); }
        100% { transform: translate(-50%, -50%) rotate(0deg); }
    }

    .vanish-final {
        opacity: 0 !important;
        transform: translate(-50%, -50%) scale(1.5) !important;
        filter: blur(15px);
        transition: all 1.5s ease-in-out !important;
    }

    .text-fade-entry {
        opacity: 0 !important;
        transition: opacity 2s ease-in-out !important;
    }
    
    .text-fade-visible {
        opacity: 0.2 !important;
    }

    .reactor-critical {
        border-color: #ff3333 !important;
        box-shadow: 0 0 50px #ff3333, inset 0 0 50px #ff3333 !important;
        animation: pulse-critical 0.2s infinite alternate !important;
    }

    @keyframes pulse-critical {
        from { opacity: 0.8; box-shadow: 0 0 50px #ff3333, inset 0 0 40px #ff3333; }
        to { opacity: 1; box-shadow: 0 0 100px #ff3333, inset 0 0 60px #ff3333; }
    }

    /* HOLOGRAM & ROCKET STYLES */
    #holo-container {
        position: relative;
        flex: 1;
        width: 100%;
        min-height: 300px;
        perspective: 1000px;
        overflow: hidden;
    }

    #rocketCanvas {
        display: block;
        width: 100%;
        height: 100%;
        filter: drop-shadow(0 0 4px rgba(0, 243, 255, 0.5)) drop-shadow(0 0 10px rgba(0, 243, 255, 0.3));
    }

    #holo-container .scan-line {
        position: absolute;
        top: 0; left: 0; width: 100%; height: 100%;
        background: linear-gradient(to bottom, transparent 50%, rgba(0, 243, 255, 0.1) 51%, transparent 52%);
        background-size: 100% 8px;
        pointer-events: none; z-index: 10; opacity: 0.3;
    }
    .scanner-bar {
        position: absolute; top: -10%; left: -10%; width: 120%; height: 20px;
        background: linear-gradient(to bottom, transparent, rgba(0, 243, 255, 0.8), transparent);
        box-shadow: 0 0 15px rgba(0, 243, 255, 0.8);
        opacity: 0.7; animation: scan 4s ease-in-out infinite; z-index: 11;
    }
    .hologram-flicker {
        position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0, 243, 255, 0.02); opacity: 0; z-index: 12;
        pointer-events: none; animation: flicker 2s infinite;
    }
    @keyframes scan { 0% { top: 10%; opacity: 0; } 10% { opacity: 1; } 90% { opacity: 1; } 100% { top: 90%; opacity: 0; } }
    @keyframes flicker { 0% { opacity: 0.05; } 5% { opacity: 0.1; } 10% { opacity: 0.05; } 100% { opacity: 0; } }

    /* Transitions & Utils */
    .floating-letter { position: fixed; z-index: 100; font-family: var(--font-display); line-height: 1; pointer-events: none; transition: all 1.5s cubic-bezier(0.25, 1, 0.5, 1); text-shadow: 0 0 10px currentColor; }
    .centered-massive { top: 50% !important; left: 50% !important; transform: translate(-50%, -50%) scale(20) !important; opacity: 0.1 !important; }
    .centered-massive-word { top: 50% !important; left: 50% !important; transform: translate(-50%, -50%) scale(8) !important; width: auto !important; white-space: nowrap; }
    
    .centered-contained { top: 50% !important; left: 50% !important; transform: translate(-50%, -50%) scale(4) !important; opacity: 1 !important; }
    .centered-contained-word { top: 50% !important; left: 50% !important; transform: translate(-50%, -50%) scale(1.5) !important; opacity: 1 !important; }
    
    /* Implode Animation for Mode X Turn Off */
    .implode-into-core {
        top: 50% !important;
        left: 50% !important;
        transform: translate(-50%, -50%) scale(0) !important;
        opacity: 0 !important;
        filter: blur(20px);
        transition: all 3s ease-in-out !important; /* CHANGED: Increased from 1.5s to 3s for smooth slow effect */
    }

    .module-page-title { position: fixed; top: 6.5%; left: 50%; transform: translate(-50%, -50%); font-family: 'Orbitron', sans-serif; font-size: 3rem; letter-spacing: 5px; opacity: 0; transition: opacity 1.5s ease; z-index: 90; text-align: center; pointer-events: none; text-shadow: 0 0 10px currentColor; }
    .module-page-title.visible { opacity: 1; }
    .pricing-grid { position: fixed; top: 55%; left: 50%; transform: translate(-50%, -50%); display: grid; grid-template-columns: repeat(3, 1fr); gap: 30px; z-index: 80; width: 80%; max-width: 1000px; pointer-events: auto; }
    .pricing-box { background: rgba(0, 10, 20, 0.4); border: 1px solid #00f3ff; height: 400px; backdrop-filter: blur(5px); transition: 0.3s; cursor: pointer; position: relative; }
    .pricing-box:hover { background: rgba(0, 243, 255, 0.1); box-shadow: 0 0 20px rgba(0, 243, 255, 0.2); transform: translateY(-10px); }
    .ring-green { border-color: #00ff00 !important; box-shadow: 0 0 25px rgba(0,255,0,0.5), inset 0 0 20px rgba(0,255,0,0.5) !important; }
    .ring-green-inner { border-color: #00ff00 !important; box-shadow: 0 0 30px rgba(0,255,0,0.5), inset 0 0 25px rgba(0,255,0,0.5) !important; }
    .ring-yellow { border-color: #ffff00 !important; box-shadow: 0 0 25px rgba(255,255,0,0.5), inset 0 0 20px rgba(255,255,0,0.5) !important; }
    .ring-yellow-inner { border-color: #ffff00 !important; box-shadow: 0 0 30px rgba(255,255,0,0.5), inset 0 0 25px rgba(255,255,0,0.5) !important; }
    .ring-white { border-color: #ffffff !important; box-shadow: 0 0 25px rgba(255,255,255,0.5), inset 0 0 20px rgba(255,255,255,0.5) !important; }
    .ring-white-inner { border-color: #ffffff !important; box-shadow: 0 0 30px rgba(255,255,255,0.5), inset 0 0 25px rgba(255,255,255,0.5) !important; }
    .ring-red { border-color: #ff3333 !important; box-shadow: 0 0 25px rgba(255,51,51,0.5), inset 0 0 20px rgba(255,51,51,0.5) !important; opacity: 1 !important; }
    .ring-red-inner { border-color: #ff3333 !important; box-shadow: 0 0 30px rgba(255,51,51,0.5), inset 0 0 25px rgba(255,51,51,0.5) !important; opacity: 1 !important; }
    .ring-teal { border-color: #00ffaa !important; box-shadow: 0 0 25px rgba(0,255,170,0.5), inset 0 0 20px rgba(0,255,170,0.5) !important; }
    .ring-teal-inner { border-color: #00ffaa !important; box-shadow: 0 0 30px rgba(0,255,170,0.5), inset 0 0 25px rgba(0,255,170,0.5) !important; }
    .ring-gold { border-color: #ffd700 !important; box-shadow: 0 0 25px rgba(255,215,0,0.5), inset 0 0 20px rgba(255,215,0,0.5) !important; }
    .ring-gold-inner { border-color: #ffd700 !important; box-shadow: 0 0 30px rgba(255,215,0,0.5), inset 0 0 25px rgba(255,215,0,0.5) !important; }
    .ring-purple { border-color: #b026ff !important; box-shadow: 0 0 25px rgba(176,38,255,0.5), inset 0 0 20px rgba(176,38,255,0.5) !important; }
    .ring-purple-inner { border-color: #b026ff !important; box-shadow: 0 0 30px rgba(176,38,255,0.5), inset 0 0 25px rgba(176,38,255,0.5) !important; }
    .sub-page-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; z-index: 50; pointer-events: none; opacity: 0; transition: opacity 1s 1s; }
    .sub-page-container.active { opacity: 1; pointer-events: auto; }
    .back-btn-container { position: absolute; bottom: 50px; }

  </style>
</head>

<body>
  
  <div id="landing-container">
      <div id="background"><div class="nebula"></div></div>
      <canvas id="stars"></canvas>
      <section class="hero" id="hero-section">
        <div class="logo-container"><div class="logo"><img src="https://raw.githubusercontent.com/mehul422/ArX/main/frontend/public/main.png" alt="ARX Logo"></div></div>
        <h1>ARX</h1><p>AUTOMATED ROCKET EXPLORATION</p>
        <button class="btn" id="start-btn">GET STARTED</button>
      </section>
  </div>

  <button id="skip-btn" onclick="skipIntro()">SKIP INTRO</button>
  <button id="modeXSkipBtn" onclick="skipModeXAnimation()">SKIP WARNING</button>
  <div id="warp-flash"></div>
  <div id="boot-text">WELCOME, BOSS</div>

  <div id="dashboard-container">
      <div id="modeXModal" class="modal-overlay">
        <div class="modal-content">
            <div class="panel-header" style="color:#ff3333; border-color:#ff3333; margin-bottom:20px;">SYSTEM OVERRIDE</div>
            <div class="modal-text">This mode does all three tasks of A.R.X. together.<br>Do you want to continue?</div>
            <div style="display:flex; justify-content:center; gap:20px;">
                <button class="nav-link accent" id="btn-yes" onclick="confirmModeX()">YES</button>
                <button class="nav-link" id="btn-no" onclick="closeModal()">NO</button>
            </div>
        </div>
      </div>

      <div id="subPage" class="sub-page-container">
          <div id="subPageContent"></div> <div class="back-btn-container">
              <button class="nav-link" id="subPageBtn" onclick="resetDashboard()">RETURN TO DASHBOARD</button>
          </div>
      </div>

      <div class="reactor-ring" id="ring1"></div>
      <div class="reactor-ring-inner" id="ring2"></div>
      
      <nav class="top-nav boot-hidden" id="topNav">
        <div class="nav-left profile-container">
            <div class="profile-bubble">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#00f3ff" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
            </div>
            <div class="dropdown-menu">
                <div class="dropdown-item" onclick="handleNavClick('INIT')">LOG IN</div>
                <div class="dropdown-item" onclick="handleNavClick('PRICING')">PRICING</div>
                <div class="dropdown-item" onclick="handleNavClick('PROTO')">CONTACT US</div>
            </div>
        </div>
        <div class="nav-right">
            <button class="nav-link" onclick="handleNavClick('INIT')">Initialize</button>
            <button class="nav-link" onclick="handleNavClick('NEW')">New User</button>
            <button class="nav-link accent" onclick="handleNavClick('PROTO')">Protocol 8</button>
        </div>
      </nav>

      <main class="main-stage">
        
        <div class="hud-panel side-panel boot-hidden">
            <div class="panel-header">ARX-E1 ENGINE OUTPUT</div>
            <div class="graph-container">
                <svg width="100%" height="100%" viewBox="0 0 300 200" preserveAspectRatio="none">
                    <defs><linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" style="stop-color:rgba(255,157,0,0);stop-opacity:1" /><stop offset="100%" style="stop-color:rgba(255,157,0,1);stop-opacity:1" /></linearGradient></defs>
                    <path class="thrust-line" d="M0,180 Q30,170 50,150 T100,100 T150,120 T200,60 T250,80 T300,20" stroke="url(#grad1)" stroke-dasharray="5,5" />
                    <line x1="0" y1="50" x2="300" y2="50" stroke="rgba(0,243,255,0.1)" stroke-width="1"/><line x1="0" y1="100" x2="300" y2="100" stroke="rgba(0,243,255,0.1)" stroke-width="1"/><line x1="0" y1="150" x2="300" y2="150" stroke="rgba(0,243,255,0.1)" stroke-width="1"/>
                </svg>
            </div>
            <div style="font-size: 0.7rem; color: var(--cyan-dim); margin-top: 5px;">> CHAMBER PRESSURE: 300 BAR<br>> LOX LEVEL: 92%<br>> CH4 LEVEL: 94%</div>
        </div>

        <div class="center-stage">
            <div class="grid-container" id="moduleGrid">
                <div class="module-card card-square boot-scale-hidden" onclick="selectModule('SYSTEM', this)">
                    <div class="tech-corner-text tr">SYS.64<br>ACT</div><div class="tech-corner-text bl">45.211</div>
                    <span class="card-label" style="font-size: 3rem; line-height: 1;">A</span><span class="card-subtext">MOTOR DEVELOPMENT</span><div class="card-border-bottom"></div>
                </div>
                <div class="module-card card-square boot-scale-hidden" onclick="selectModule('ARMOR', this)">
                    <div class="tech-corner-text tr">MK.85<br>RDY</div><div class="tech-corner-text bl">98.4%</div>
                    <span class="card-label" style="font-size: 3rem; line-height: 1;">R</span><span class="card-subtext">ROCKET DEVELOPMENT</span><div class="card-border-bottom"></div>
                </div>
                <div class="module-card card-square boot-scale-hidden" onclick="selectModule('NETWORK', this)">
                    <div class="tech-corner-text tr">NET.09<br>UPL</div><div class="tech-corner-text bl">120 TB/s</div>
                    <span class="card-label" style="font-size: 3rem; line-height: 1;">X</span><span class="card-subtext">SIMULATIONS</span><div class="card-border-bottom"></div>
                </div>
                <div class="module-card card-wide red-alert boot-scale-hidden" id="modeXBtn" onclick="selectModule('ADVANCED', this)">
                    <div class="tech-corner-text tr">ADV.OP<br>SECURE</div><div class="tech-corner-text bl">LAT: 34.05 LON: -118.25</div>
                    <span class="card-label">MODE X</span> 
                    <span class="card-subtext" style="color: #ff4d4d; text-shadow: 0 0 15px #ff0000, 0 0 5px #ff0000; opacity: 1; font-weight: bold;">THREAT LEVEL: HIGH</span>
                    <div class="card-border-bottom"></div>
                </div>
            </div>
        </div>

        <div class="hud-panel side-panel boot-hidden">
            <div class="panel-header">ARX-V1 TELEMETRY</div>
            
            <div id="holo-container">
                <div class="scan-line"></div>
                <div class="scanner-bar"></div>
                <div class="hologram-flicker"></div>
                <canvas id="rocketCanvas"></canvas>
            </div>
            
            <div style="font-size: 0.7rem; color: var(--cyan-dim); text-align: right;">SCANNING HULL...<br>TILES: 100% SECURE<br>PAYLOAD: DEPLOYED</div>
        </div>
      </main>
  </div>


  <script>
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    let voiceAudio, bgmAudio, alarmAudio;
    let bootTimeouts = [];
    let modeXTimeouts = []; 
    let warpInterval;
    let modeXHoverTimer; 
    let arxHoverTimer; 
    let hasBooted = false; 
    let isTransitioning = false;

    const floatSound = new Audio("https://raw.githubusercontent.com/mehul422/ArX/main/frontend/public/axr%20float.mp3");
    const modeXHoverSound = new Audio("https://raw.githubusercontent.com/mehul422/ArX/main/frontend/public/mode%20x%20option%20slexes.mp3");
    const popupSound = new Audio("https://raw.githubusercontent.com/mehul422/ArX/main/frontend/public/pop%20up.mp3");

    // NEW WARP AUDIO
    const warpAudio = new Audio("https://raw.githubusercontent.com/mehul422/ArX/main/frontend/public/try%20one.mp3");

    // ==========================================
    // LANDING PAGE AUDIO LOGIC (FINAL FIX)
    // ==========================================
    const landingAudio = new Audio("https://raw.githubusercontent.com/mehul422/ArX/main/frontend/public/ethmusic.mp3");
    landingAudio.loop = true;
    landingAudio.volume = 0.5;
    
    // FLAG TO TRACK IF WE STARTED
    let hasLaunched = false;

    // 1. ATTEMPT IMMEDIATE PLAYBACK
    const playPromise = landingAudio.play();

    if (playPromise !== undefined) {
        playPromise.then(_ => {
            console.log("Audio autoplayed successfully.");
        }).catch(error => {
            console.log("Autoplay prevented. Waiting for user interaction.");
            
            const enableAudio = () => {
                // *** CRITICAL CHECK ***
                // If the user has already clicked "Get Started", DO NOT play.
                if (hasLaunched) {
                    window.removeEventListener('click', enableAudio);
                    window.removeEventListener('keydown', enableAudio);
                    window.removeEventListener('touchstart', enableAudio);
                    return;
                }
                
                landingAudio.play();
                // Clean up listeners immediately
                window.removeEventListener('click', enableAudio);
                window.removeEventListener('keydown', enableAudio);
                window.removeEventListener('touchstart', enableAudio);
            };

            window.addEventListener('click', enableAudio);
            window.addEventListener('keydown', enableAudio);
            window.addEventListener('touchstart', enableAudio);
        });
    }

    // ==========================================
    // STAR LOGIC
    // ==========================================
    const canvas = document.getElementById("stars");
    const ctx = canvas.getContext("2d");
    let stars = [];
    const STAR_COUNT = 2500; let speed = 0.5; let warp = false; let animationId;

    function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
    window.addEventListener("resize", resize); resize();

    function initStars() {
      stars = [];
      for (let i = 0; i < STAR_COUNT; i++) {
        stars.push({ x: (Math.random()-0.5)*canvas.width, y: (Math.random()-0.5)*canvas.height, z: Math.random()*canvas.width, color: Math.random()>0.3?"200, 240, 255":"255, 255, 255" });
      }
    }

    function animateStars() {
      ctx.clearRect(0, 0, canvas.width, canvas.height); 
      ctx.globalCompositeOperation = "lighter";
      let cx = canvas.width / 2; let cy = canvas.height / 2;
      if (warp && speed > 20) { cx += (Math.random() - 0.5) * (speed / 4); cy += (Math.random() - 0.5) * (speed / 4); }
      for (const s of stars) {
        s.z -= speed;
        if (s.z <= 0) { s.z = canvas.width; s.x = (Math.random()-0.5)*canvas.width; s.y = (Math.random()-0.5)*canvas.height; }
        const k = 400 / s.z; const x = s.x * k + cx; const y = s.y * k + cy;
        const trailLength = warp ? (speed * 1.5) : (speed * 5); 
        const prevZ = s.z + trailLength; const prevK = 400 / prevZ; const px = s.x * prevK + cx; const py = s.y * prevK + cy;
        const depthAlpha = 1 - (s.z / canvas.width);
        if (x >= 0 && x <= canvas.width && y >= 0 && y <= canvas.height) {
            ctx.beginPath(); ctx.strokeStyle = `rgba(${s.color}, ${depthAlpha})`;
            let thickness = (1 - s.z / canvas.width) * 3; if(warp) thickness *= 1.5;
            ctx.lineWidth = Math.max(0.1, thickness); ctx.lineCap = 'round';
            ctx.moveTo(px, py); ctx.lineTo(x, y); ctx.stroke();
        }
      }
      ctx.globalCompositeOperation = "source-over"; 
      animationId = requestAnimationFrame(animateStars);
    }
    initStars(); animateStars();

    function startWarp() {
      warp = true; document.body.classList.add('hyperspace-active'); skipBtn.classList.add('visible'); 
      warpInterval = setInterval(() => { if(speed < 80) speed *= 1.05; if(speed < 2) speed += 0.5; if (speed > 80) clearInterval(warpInterval); }, 20);
    }
    function stopWarp() { warp = false; speed = 0.5; clearInterval(warpInterval); }

    // ==========================================
    // AUDIO & INTRO LOGIC
    // ==========================================
    function playBootSound() {
        if(hasBooted) return;
        if(audioCtx.state === 'suspended') audioCtx.resume();
        bgmAudio = new Audio("https://raw.githubusercontent.com/mehul422/ArX/main/frontend/public/sound%20track%20ai'%20main.mp3");
        bgmAudio.volume = 0.8;
        voiceAudio = new Audio("https://raw.githubusercontent.com/mehul422/ArX/main/frontend/public/main%20jarvis.mp3"); 
        voiceAudio.volume = 1.0; 
        voiceAudio.play().catch(e => console.log("Voice Audio Error:", e));
        bgmAudio.play().catch(e => console.log("BGM Audio Error:", e));
        hasBooted = true; 
    }

    function attachHoverSounds() {
        const standardCards = document.querySelectorAll('.module-card:not(.red-alert)');
        const modeXCard = document.getElementById('modeXBtn');
        standardCards.forEach(card => {
            card.addEventListener('mouseenter', () => { arxHoverTimer = setTimeout(() => { const sound = floatSound.cloneNode(); sound.volume = 0.5; sound.play().catch(e => {}); }, 200); });
            card.addEventListener('mouseleave', () => { clearTimeout(arxHoverTimer); });
        });
        if(modeXCard) {
            modeXCard.addEventListener('mouseenter', () => { modeXHoverTimer = setTimeout(() => { const sound = modeXHoverSound.cloneNode(); sound.volume = 0.6; sound.play().catch(e => {}); }, 200); });
            modeXCard.addEventListener('mouseleave', () => { clearTimeout(modeXHoverTimer); });
        }
        const modalBtns = document.querySelectorAll('#modeXModal button');
        modalBtns.forEach(btn => { btn.addEventListener('mouseenter', () => { const sound = floatSound.cloneNode(); sound.volume = 0.5; sound.play().catch(e => {}); }); });
    }

    function skipIntro() {
        // STOP LANDING MUSIC IF SKIPPING
        landingAudio.pause();
        landingAudio.currentTime = 0;
        
        // STOP WARP SOUND IF SKIPPING
        warpAudio.pause();
        warpAudio.currentTime = 0;

        bootTimeouts.forEach(id => clearTimeout(id)); bootTimeouts = [];
        stopWarp(); 
        landingContainer.style.display = 'none'; flash.style.display = 'none'; bootText.style.display = 'none'; skipBtn.style.display = 'none';
        document.body.style.backgroundColor = 'black'; document.body.classList.add('dashboard-mode'); dashboardContainer.style.display = 'block';
        const rings = document.querySelectorAll('.reactor-ring, .reactor-ring-inner');
        const nav = document.getElementById('topNav');
        const panels = document.querySelectorAll('.side-panel');
        const cards = document.querySelectorAll('.module-card');
        rings.forEach(r => r.style.opacity = '0.8');
        nav.classList.remove('boot-hidden'); nav.classList.add('boot-visible');
        panels.forEach(p => { p.classList.remove('boot-hidden'); p.classList.add('boot-visible'); });
        cards.forEach(card => { card.classList.remove('boot-scale-hidden'); card.classList.add('boot-scale-visible'); });
        if(audioCtx.state === 'suspended') audioCtx.resume();
        if(voiceAudio) { voiceAudio.pause(); voiceAudio.currentTime = 0; }
        if(bgmAudio) { bgmAudio.pause(); bgmAudio.currentTime = 0; }
        hasBooted = true; attachHoverSounds();
        
        // --- FORCE RESIZE CALL ---
        requestAnimationFrame(() => {
            updateRocketSize();
        });
    }

    const btn = document.getElementById('start-btn');
    const hero = document.getElementById('hero-section');
    const flash = document.getElementById('warp-flash');
    const landingContainer = document.getElementById('landing-container');
    const dashboardContainer = document.getElementById('dashboard-container');
    const bootText = document.getElementById('boot-text');
    const skipBtn = document.getElementById('skip-btn');

    btn.addEventListener('click', (e) => {
        e.preventDefault();
        
        // *** MARK AS LAUNCHED ***
        hasLaunched = true;

        // --- STOP LANDING MUSIC ABRUPTLY ---
        landingAudio.pause();
        landingAudio.currentTime = 0;

        // --- START WARP SOUND IMMEDIATELY ---
        warpAudio.currentTime = 0;
        warpAudio.volume = 1.0;
        warpAudio.play();

        if(audioCtx.state === 'suspended') audioCtx.resume();
        startWarp();
        hero.classList.add('launching');
        bootTimeouts.push(setTimeout(() => {
            
            // --- STOP WARP SOUND AT FLASH ---
            warpAudio.pause();
            warpAudio.currentTime = 0;

            flash.classList.add('active');
            bootTimeouts.push(setTimeout(() => {
                stopWarp(); landingContainer.style.display = 'none'; skipBtn.style.display = 'none'; document.body.style.backgroundColor = 'black'; bootText.classList.add('boot-text-visible'); playBootSound();
                bootTimeouts.push(setTimeout(() => {
                    bootText.classList.remove('boot-text-visible');
                    document.body.classList.add('dashboard-mode'); dashboardContainer.style.display = 'block';
                    flash.style.transition = 'opacity 1s ease'; flash.style.opacity = '0';
                    bootTimeouts.push(setTimeout(() => { flash.style.display = 'none'; }, 1000));
                    const rings = document.querySelectorAll('.reactor-ring, .reactor-ring-inner');
                    const nav = document.getElementById('topNav');
                    const panels = document.querySelectorAll('.side-panel');
                    const cards = document.querySelectorAll('.module-card');
                    rings.forEach(r => r.style.opacity = '0.8'); 
                    bootTimeouts.push(setTimeout(() => { nav.classList.remove('boot-hidden'); nav.classList.add('boot-visible'); }, 500));
                    bootTimeouts.push(setTimeout(() => { 
                        panels.forEach(p => { p.classList.remove('boot-hidden'); p.classList.add('boot-visible'); });
                        // --- FORCE RESIZE CALL ---
                        updateRocketSize();
                    }, 1000));
                    cards.forEach((card, index) => { bootTimeouts.push(setTimeout(() => { card.classList.remove('boot-scale-hidden'); card.classList.add('boot-scale-visible'); }, 1500 + (index * 200))); });
                    bootTimeouts.push(setTimeout(() => { attachHoverSounds(); }, 2000));
                }, 2000));
            }, 1000));
        }, 2500));
    });

    // ==========================================
    // NAVIGATION LOGIC
    // ==========================================
    function selectModule(id, element) {
        if (isTransitioning) return;
        if(id === 'ADVANCED') { 
            const sound = popupSound.cloneNode(); sound.volume = 0.7; sound.play().catch(e => {});
            document.getElementById('modeXModal').style.display = 'flex'; return; 
        }
        isTransitioning = true; 
        // ADDED gridColor to mapping
        const mapping = { 
            'SYSTEM': { text: 'A', title: 'MOTOR DEVELOPMENT', ringClass: 'ring-green', ringInnerClass: 'ring-green-inner', color: '#00ff00', gridColor: '0, 255, 0' }, 
            'ARMOR': { text: 'R', title: 'ROCKET DEVELOPMENT', ringClass: 'ring-yellow', ringInnerClass: 'ring-yellow-inner', color: '#ffff00', gridColor: '255, 255, 0' }, 
            'NETWORK':{ text: 'X', title: 'SIMULATIONS', ringClass: 'ring-white', ringInnerClass: 'ring-white-inner', color: '#ffffff', gridColor: '255, 255, 255' } 
        };
        const config = mapping[id];
        if(!config) { isTransitioning = false; return; }
        
        // SET GRID COLOR
        document.documentElement.style.setProperty('--grid-color', config.gridColor);

        if(voiceAudio) { voiceAudio.pause(); voiceAudio.currentTime = 0; }
        if(bgmAudio) { bgmAudio.pause(); bgmAudio.currentTime = 0; }
        const sound = popupSound.cloneNode(); sound.volume = 0.5; sound.play().catch(e => {});
        const letterSpan = element.querySelector('.card-label');
        const rect = letterSpan.getBoundingClientRect();
        const floater = document.createElement('span');
        floater.innerText = config.text; floater.dataset.title = config.title; floater.className = 'floating-letter';
        floater.style.top = rect.top + 'px'; floater.style.left = rect.left + 'px'; floater.style.width = rect.width + 'px'; floater.style.height = rect.height + 'px';
        floater.style.color = config.color; floater.style.fontSize = getComputedStyle(letterSpan).fontSize; floater.id = 'activeFloater';
        document.body.appendChild(floater);
        requestAnimationFrame(() => {
            floater.classList.add('centered-massive');
            document.getElementById('topNav').classList.add('fade-exit');
            document.querySelectorAll('.side-panel').forEach(el => el.classList.add('fade-exit'));
            document.getElementById('moduleGrid').classList.add('fade-exit');
            document.getElementById('ring1').classList.add(config.ringClass);
            document.getElementById('ring2').classList.add(config.ringInnerClass);
        });
        document.getElementById('subPageBtn').innerText = "RETURN TO DASHBOARD"; document.getElementById('subPageBtn').onclick = resetDashboard;
        setTimeout(() => { document.getElementById('subPage').classList.add('active'); }, 800);
    }

    function handleNavClick(type) {
        if (isTransitioning) return; isTransitioning = true;
        const sound = popupSound.cloneNode(); sound.volume = 0.5; sound.play().catch(e => {});
        if(voiceAudio) { voiceAudio.pause(); voiceAudio.currentTime = 0; }
        if(bgmAudio) { bgmAudio.pause(); bgmAudio.currentTime = 0; }
        document.getElementById('subPageContent').innerHTML = '';
        
        let ringClass, ringInnerClass, color, textContent; 
        let isPricing = false;
        let newGridColor = '0, 243, 255'; // Default Cyan

        if (type === 'INIT') { 
            color = '#00f3ff'; textContent = "LOG IN"; 
            newGridColor = '0, 243, 255';
        } else if (type === 'NEW') { 
            ringClass = 'ring-teal'; ringInnerClass = 'ring-teal-inner'; color = '#00ffaa'; textContent = "NEW USER"; 
            newGridColor = '0, 255, 170';
        } else if (type === 'PROTO') { 
            ringClass = 'ring-gold'; ringInnerClass = 'ring-gold-inner'; color = '#ffd700'; textContent = "CONTACT US"; 
            newGridColor = '255, 215, 0';
        } else if (type === 'PRICING') { 
            ringClass = 'ring-purple'; ringInnerClass = 'ring-purple-inner'; color = '#b026ff'; textContent = "PRICING"; isPricing = true; 
            newGridColor = '176, 38, 255';
        }

        // SET GRID COLOR
        document.documentElement.style.setProperty('--grid-color', newGridColor);

        document.getElementById('topNav').classList.add('fade-exit');
        document.querySelectorAll('.side-panel').forEach(el => el.classList.add('fade-exit'));
        document.getElementById('moduleGrid').classList.add('fade-exit');
        const r1 = document.getElementById('ring1'); const r2 = document.getElementById('ring2');
        if (ringClass) { r1.classList.add(ringClass); r2.classList.add(ringInnerClass); }
        const floater = document.createElement('span');
        floater.innerText = textContent; floater.className = 'floating-letter centered-contained-word'; floater.style.color = color; floater.style.fontSize = '3rem'; floater.style.position = 'fixed'; floater.style.top = isPricing ? '15%' : '50%'; floater.style.left = '50%'; floater.style.transform = 'translate(-50%, -50%)'; floater.style.opacity = '0'; floater.style.transition = 'opacity 1s ease, top 1s ease'; floater.id = 'activeFloater';
        document.body.appendChild(floater);
        if (isPricing) {
            document.getElementById('subPageContent').innerHTML = `<div class="pricing-grid"><div class="pricing-box"></div><div class="pricing-box"></div><div class="pricing-box"></div></div>`;
            setTimeout(() => { document.querySelectorAll('.pricing-box').forEach(box => { box.addEventListener('mouseenter', () => { const s = floatSound.cloneNode(); s.volume = 0.5; s.play().catch(e=>{}); }); }); }, 100);
        }
        requestAnimationFrame(() => { floater.style.opacity = '1'; });
        document.getElementById('subPageBtn').innerText = "RETURN TO DASHBOARD"; document.getElementById('subPageBtn').onclick = resetDashboard;
        setTimeout(() => { document.getElementById('subPage').classList.add('active'); }, 500);
    }

    document.addEventListener('keydown', () => {
        const floater = document.getElementById('activeFloater');
        if(floater) {
            if(floater.classList.contains('centered-massive')) {
                floater.classList.remove('centered-massive'); floater.classList.add('centered-contained');
                if(floater.dataset.title) { const titleEl = document.createElement('div'); titleEl.innerText = floater.dataset.title; titleEl.className = 'module-page-title'; titleEl.style.color = floater.style.color; titleEl.id = 'activeModuleTitle'; document.body.appendChild(titleEl); requestAnimationFrame(() => { titleEl.classList.add('visible'); }); }
            } else if (floater.classList.contains('centered-massive-word')) {
                floater.classList.remove('centered-massive-word'); floater.classList.add('centered-contained-word');
                if(floater.dataset.title) { const titleEl = document.createElement('div'); titleEl.innerText = floater.dataset.title; titleEl.className = 'module-page-title'; titleEl.style.color = floater.style.color; titleEl.id = 'activeModuleTitle'; document.body.appendChild(titleEl); requestAnimationFrame(() => { titleEl.classList.add('visible'); }); }
            }
        }
    });

    function resetDashboard() {
        // RESET GRID COLOR TO DEFAULT CYAN
        document.documentElement.style.setProperty('--grid-color', '0, 243, 255');

        document.getElementById('subPage').classList.remove('active'); document.getElementById('subPageContent').innerHTML = '';
        const floaters = document.querySelectorAll('.floating-letter'); floaters.forEach(f => { f.style.opacity = '0'; setTimeout(() => f.remove(), 500); });
        const titleEl = document.getElementById('activeModuleTitle'); if(titleEl) { titleEl.style.opacity = '0'; setTimeout(() => titleEl.remove(), 500); }
        document.getElementById('topNav').classList.remove('fade-exit');
        document.querySelectorAll('.side-panel').forEach(el => el.classList.remove('fade-exit'));
        document.getElementById('moduleGrid').classList.remove('fade-exit');
        const ring1 = document.getElementById('ring1'); const ring2 = document.getElementById('ring2');
        ring1.className = 'reactor-ring'; ring2.className = 'reactor-ring-inner';
        ring1.classList.remove('ring-teal', 'ring-gold', 'ring-green', 'ring-yellow', 'ring-white', 'ring-red', 'ring-purple');
        ring2.classList.remove('ring-teal-inner', 'ring-gold-inner', 'ring-green-inner', 'ring-yellow-inner', 'ring-white-inner', 'ring-red-inner', 'ring-purple-inner');
        setTimeout(() => { isTransitioning = false; updateRocketSize(); }, 500);
    }

    function closeModal() { document.getElementById('modeXModal').style.display = 'none'; }
    
    function confirmModeX() {
        closeModal();
        // SET GRID TO RED
        document.documentElement.style.setProperty('--grid-color', '255, 51, 51');

        if(voiceAudio) { voiceAudio.pause(); voiceAudio.currentTime = 0; }
        if(bgmAudio) { bgmAudio.pause(); bgmAudio.currentTime = 0; }
        
        alarmAudio = new Audio('https://raw.githubusercontent.com/mehul422/ArX/main/frontend/public/alarm-301729.mp3');
        alarmAudio.loop = true;
        alarmAudio.volume = 0.7;
        alarmAudio.play();

        document.getElementById('modeXSkipBtn').classList.add('visible');

        const modeXCard = document.getElementById('modeXBtn');
        const ring1 = document.getElementById('ring1');
        const ring2 = document.getElementById('ring2');

        document.querySelectorAll('.side-panel').forEach(el => el.classList.add('fade-exit'));
        document.getElementById('topNav').classList.add('fade-exit');
        document.querySelectorAll('.module-card').forEach(el => { if(el.id !== 'modeXBtn') el.classList.add('fade-exit'); });

        modeXCard.classList.add('mode-x-center');

        modeXTimeouts.push(setTimeout(() => {
            ring1.classList.add('reactor-critical'); ring2.classList.add('reactor-critical');
            modeXTimeouts.push(setTimeout(() => {
                modeXCard.classList.add('shake-hard');
                
                // --- START CUSTOM FADE SEQUENCE ---
                modeXTimeouts.push(setTimeout(() => {
                    // 1. Fade OUT the card smoothly
                    modeXCard.classList.add('vanish-final'); 
                    
                    if(alarmAudio) { alarmAudio.pause(); alarmAudio.currentTime = 0; }
                    document.getElementById('modeXSkipBtn').classList.remove('visible'); 
                    
                    ring1.classList.remove('reactor-critical', 'vanish-final');
                    ring2.classList.remove('reactor-critical', 'vanish-final');
                    
                    ring1.classList.add('ring-red');
                    ring2.classList.add('ring-red-inner');
                    
                    // 2. Create Text immediately with 0 opacity
                    const floater = document.createElement('span');
                    floater.innerText = "MODE X";
                    floater.dataset.title = "A.R.X"; 
                    floater.className = 'floating-letter centered-massive-word text-fade-entry'; // Start invisible
                    floater.style.color = '#ff3333';
                    floater.style.fontSize = '4rem'; 
                    floater.id = 'activeFloater';
                    document.body.appendChild(floater);
                    
                    // 3. Trigger Slow Fade IN
                    requestAnimationFrame(() => {
                        setTimeout(() => {
                             floater.classList.add('text-fade-visible');
                        }, 50);
                    });

                    const subPageBtn = document.getElementById('subPageBtn');
                    subPageBtn.innerText = "TURN OFF MODE X";
                    subPageBtn.onclick = turnOffModeX; 

                    document.getElementById('subPage').classList.add('active');
                    document.body.style.backgroundColor = '#000'; 
                    
                }, 1500)); 
            }, 1500));
        }, 1000)); 
    }

    function skipModeXAnimation() {
        modeXTimeouts.forEach(id => clearTimeout(id));
        modeXTimeouts = [];

        if(alarmAudio) { alarmAudio.pause(); alarmAudio.currentTime = 0; }

        document.getElementById('modeXSkipBtn').classList.remove('visible');

        const modeXCard = document.getElementById('modeXBtn');
        const ring1 = document.getElementById('ring1');
        const ring2 = document.getElementById('ring2');

        modeXCard.classList.add('vanish-final', 'mode-x-center'); 
        
        ring1.classList.remove('reactor-critical');
        ring2.classList.remove('reactor-critical');
        ring1.classList.add('ring-red');
        ring2.classList.add('ring-red-inner');

        const floater = document.createElement('span');
        floater.innerText = "MODE X";
        floater.dataset.title = "A.R.X";
        floater.className = 'floating-letter centered-massive-word text-fade-entry text-fade-visible';
        floater.style.color = '#ff3333';
        floater.style.fontSize = '4rem'; 
        floater.id = 'activeFloater';
        document.body.appendChild(floater);

        const subPageBtn = document.getElementById('subPageBtn');
        subPageBtn.innerText = "TURN OFF MODE X";
        subPageBtn.onclick = turnOffModeX; 

        document.getElementById('subPage').classList.add('active');
        document.body.style.backgroundColor = '#000';
    }

    function turnOffModeX() {
        const floater = document.getElementById('activeFloater'); 
        if(floater) { 
            // IMPLODE Animation - REVISED FOR 3 SECONDS SMOOTHNESS
            floater.classList.remove('centered-massive-word', 'text-fade-visible');
            floater.classList.add('implode-into-core'); 
            setTimeout(() => floater.remove(), 3000); // Wait 3s for the CSS animation to finish
        }
        const titleEl = document.getElementById('activeModuleTitle'); if(titleEl) { titleEl.style.opacity = '0'; setTimeout(() => titleEl.remove(), 2000); }
        document.getElementById('subPage').classList.remove('active');
        
        // Wait until the implosion is nearly done before bringing back the UI
        setTimeout(() => {
            const ring1 = document.getElementById('ring1'); const ring2 = document.getElementById('ring2'); ring1.classList.remove('ring-red'); ring2.classList.remove('ring-red-inner');
            setTimeout(() => {
                document.getElementById('topNav').classList.add('boot-hidden'); document.querySelectorAll('.side-panel').forEach(p => p.classList.add('boot-hidden'));
                document.querySelectorAll('.module-card').forEach(c => { c.classList.remove('fade-exit', 'vanish-final', 'mode-x-center', 'shake-hard'); c.classList.add('boot-scale-hidden'); if(c.id === 'modeXBtn') c.style = ""; });
                document.getElementById('topNav').classList.remove('fade-exit'); document.querySelectorAll('.side-panel').forEach(p => p.classList.remove('fade-exit'));
                setTimeout(() => { document.getElementById('topNav').classList.remove('boot-hidden'); document.getElementById('topNav').classList.add('boot-visible'); }, 500);
                setTimeout(() => { document.querySelectorAll('.side-panel').forEach(p => { p.classList.remove('boot-hidden'); p.classList.add('boot-visible'); }); updateRocketSize(); }, 1000);
                const cards = document.querySelectorAll('.module-card'); cards.forEach((card, index) => { setTimeout(() => { card.classList.remove('boot-scale-hidden'); card.classList.add('boot-scale-visible'); }, 1500 + (index * 200)); });
                setTimeout(() => { isTransitioning = false; }, 2000);
            }, 2000);
        }, 2500); // Increased delay to sync with slow implode
    }
    
    setInterval(() => { document.querySelectorAll('.tech-corner-text.bl').forEach(el => { if(Math.random() > 0.7) el.innerText = (Math.random() * 100).toFixed(2) + "%"; }); }, 2000);


    // ==========================================
    // STARSHIP HOLOGRAM 3D ENGINE
    // ==========================================
    const rocketCanvasEl = document.getElementById('rocketCanvas');
    const holoContainer = document.getElementById('holo-container');
    const rocketCtx = rocketCanvasEl.getContext('2d');
    const rocketDpr = window.devicePixelRatio || 1;

    const resizeObserver = new ResizeObserver(entries => {
        for (let entry of entries) {
            updateRocketSize();
        }
    });
    resizeObserver.observe(holoContainer);

    function updateRocketSize() {
        const rect = holoContainer.getBoundingClientRect();
        if(rect.width === 0 || rect.height === 0) return;
        
        rocketCanvasEl.width = rect.width * rocketDpr;
        rocketCanvasEl.height = rect.height * rocketDpr;
        rocketCtx.scale(rocketDpr, rocketDpr);
    }
    
    const ROCKET_COLOR = '#00f3ff'; 
    const ROCKET_COLOR_DIM = 'rgba(0, 243, 255, 0.15)';
    const ROCKET_ROTATION_SPEED = 0.01;
    
    class Point3D { constructor(x, y, z) { this.x = x; this.y = y; this.z = z; } }
    let rocketVertices = []; let rocketEdges = [];

    function createRocketRing(y, radius, segments) {
        let startIdx = rocketVertices.length;
        for (let i = 0; i < segments; i++) {
            let theta = (i / segments) * Math.PI * 2;
            let x = Math.cos(theta) * radius; let z = Math.sin(theta) * radius;
            rocketVertices.push(new Point3D(x, y, z));
        }
        for (let i = 0; i < segments; i++) { rocketEdges.push([startIdx + i, startIdx + ((i + 1) % segments)]); }
        return startIdx;
    }

    function initRocketModel() {
        rocketVertices = []; rocketEdges = [];
        const SEGMENTS = 16; const R = 40; 
        
        // --- SUPER HEAVY BOOSTER ---
        let b1 = createRocketRing(200, R, SEGMENTS); 
        let b2 = createRocketRing(150, R, SEGMENTS);
        let b3 = createRocketRing(50, R, SEGMENTS);
        let b4 = createRocketRing(-40, R, SEGMENTS); 
        for (let i = 0; i < SEGMENTS; i++) { rocketEdges.push([b1 + i, b4 + i]); }
        // Grid Fins
        [0, 4, 8, 12].forEach(idx => {
            let p = rocketVertices[b4 + idx]; 
            let finTip = new Point3D(p.x * 1.4, p.y, p.z * 1.4);
            let finIdx = rocketVertices.push(finTip) - 1;
            rocketEdges.push([b4 + idx, finIdx]); rocketEdges.push([b3 + idx, finIdx]); 
        });

        // --- STARSHIP (UPPER STAGE) ---
        let s1 = b4; 
        let s2 = createRocketRing(-100, R, SEGMENTS); 
        let s3 = createRocketRing(-160, R * 0.7, SEGMENTS); 
        let s4 = createRocketRing(-190, 0, SEGMENTS); 
        for (let i = 0; i < SEGMENTS; i++) { rocketEdges.push([s1 + i, s2 + i]); rocketEdges.push([s2 + i, s3 + i]); rocketEdges.push([s3 + i, s4 + i]); }

        addRocketFlap(-50, -90, R, 1.8, 0); addRocketFlap(-50, -90, R, 1.8, Math.PI); 
        addRocketFlap(-130, -150, R, 1.5, 0); addRocketFlap(-130, -150, R, 1.5, Math.PI);
        addRocketEngine(0, 0, 200, 10); addRocketEngine(15, 0, 200, 8); addRocketEngine(-15, 0, 200, 8);
    }

    function addRocketFlap(yBottom, yTop, radius, reach, angleOffset) {
        let x1 = Math.cos(angleOffset) * radius; let z1 = Math.sin(angleOffset) * radius;
        let x2 = Math.cos(angleOffset) * (radius * reach); let z2 = Math.sin(angleOffset) * (radius * reach);
        let p1 = new Point3D(x1, yBottom, z1); let p2 = new Point3D(x2, yBottom - 10, z2); 
        let p3 = new Point3D(x2, yTop + 10, z2); let p4 = new Point3D(x1, yTop, z1);        
        let idx = rocketVertices.length;
        rocketVertices.push(p1, p2, p3, p4);
        rocketEdges.push([idx, idx+1]); rocketEdges.push([idx+1, idx+2]); rocketEdges.push([idx+2, idx+3]); rocketEdges.push([idx+3, idx]); rocketEdges.push([idx, idx+2]);
    }

    function addRocketEngine(xOffset, zOffset, y, size) {
        let tip = new Point3D(xOffset, y + 20, zOffset); let idx = rocketVertices.push(tip) - 1;
        let ringBase = createRocketRing(y, size, 8);
        for(let i=0; i<8; i++) {
            rocketVertices[ringBase+i].x += xOffset; rocketVertices[ringBase+i].z += zOffset;
            rocketEdges.push([idx, ringBase+i]); 
        }
    }
    
    let rocketAngle = 0;

    function renderRocket() {
        const w = rocketCanvasEl.width / rocketDpr;
        const h = rocketCanvasEl.height / rocketDpr;
        if (w === 0 || h === 0) { requestAnimationFrame(renderRocket); return; }

        rocketCtx.clearRect(0, 0, w, h);
        
        const cx = w / 2;
        const cy = h / 2;
        
        const globalScale = Math.min(w, h) * 0.0035; 

        rocketAngle += ROCKET_ROTATION_SPEED;
        const sin = Math.sin(rocketAngle); const cos = Math.cos(rocketAngle);
        
        rocketCtx.lineWidth = 2; 
        rocketCtx.lineJoin = 'round';
        
        let projected = rocketVertices.map(v => {
            let x = v.x * cos - v.z * sin; let z = v.x * sin + v.z * cos;
            let scale = (1000 / (1000 + z)) * globalScale; 
            return { x: cx + x * scale, y: cy + v.y * scale, z: z };
        });

        rocketEdges.forEach(edge => {
            const p1 = projected[edge[0]]; const p2 = projected[edge[1]];
            let isBack = p1.z < 0 && p2.z < 0; 
            rocketCtx.beginPath(); rocketCtx.moveTo(p1.x, p1.y); rocketCtx.lineTo(p2.x, p2.y);
            if (isBack) { rocketCtx.strokeStyle = ROCKET_COLOR_DIM; } else { rocketCtx.strokeStyle = ROCKET_COLOR; }
            rocketCtx.stroke();
        });
        requestAnimationFrame(renderRocket);
    }

    initRocketModel();
    renderRocket();

  </script>
</body>
</html>